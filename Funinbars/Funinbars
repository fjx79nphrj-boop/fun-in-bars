<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ff0080">
    <meta name="description" content="Social games, challenges, and fun activities for nights out">
    <link rel="manifest" href="manifest.json">
    <title>Fun in Bars</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZF0VKJYB21"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-ZF0VKJYB21');
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a0f2e 50%, #0a0e27 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 600px; margin: 0 auto; }
        h1 { 
            text-align: center; 
            font-size: 2.5em; 
            color: #ff0080; 
            margin-bottom: 10px;
            font-weight: 900;
        }
        .tagline { text-align: center; color: #00ffff; font-weight: 600; margin-bottom: 30px; }
        
        .phases {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            overflow-x: auto;
        }
        .phase-btn {
            flex: 1;
            min-width: 130px;
            padding: 12px;
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #00ffff;
            color: #00ffff;
            border-radius: 15px;
            font-weight: 700;
            font-size: 0.85em;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.3s;
        }
        .phase-btn:hover { background: rgba(0, 255, 255, 0.2); transform: translateY(-3px); }
        .phase-btn.active { background: #00ffff; color: #0a0e27; }
        
        .phase-content { display: none; }
        .phase-content.active { display: block; }
        
        .phase-title {
            font-size: 1.8em;
            text-align: center;
            color: #ffff00;
            margin-bottom: 20px;
            font-weight: 900;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 0, 128, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .card:hover { 
            border-color: #ff0080;
            transform: translateY(-5px);
        }
        .card.expanded { border-color: #ff0080; }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .card-title { font-size: 1.4em; font-weight: 700; color: #ff0080; }
        .expand-icon { font-size: 1.5em; color: #00ffff; transition: transform 0.3s; }
        .card.expanded .expand-icon { transform: rotate(180deg); }
        
        .card-content { display: none; margin-top: 20px; }
        .card.expanded .card-content { display: block; }
        
        .item {
            background: rgba(0, 255, 255, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #00ffff;
        }
        
        .list-item {
            background: rgba(255, 0, 128, 0.1);
            padding: 20px;
            margin: 15px 0;
            border-radius: 15px;
            border-left: 5px solid #ff0080;
        }
        .list-title { font-size: 1.2em; font-weight: 700; color: #00ffff; margin-bottom: 8px; }
        
        .btn {
            background: linear-gradient(135deg, #ff0080, #b000ff);
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            text-transform: uppercase;
            font-size: 1em;
        }
        .btn:hover { transform: scale(1.05); }
        
        .counter {
            text-align: center;
            font-size: 4em;
            font-weight: 700;
            color: #ffff00;
            margin: 30px 0;
        }
        
        .widget-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            border-radius: 20px;
            border: 2px solid #ffff00;
            margin: 20px 0;
            position: relative;
        }
        
        .widget-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #00ffff;
            border-radius: 10px;
            padding: 12px;
            color: white;
            font-size: 1.1em;
            font-weight: 700;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .bar-chart {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            height: 350px;
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid rgba(255, 0, 128, 0.3);
            position: relative;
        }
        
        .bar {
            width: 100px;
            background: linear-gradient(180deg, #ff0080, #b000ff);
            border-radius: 10px 10px 0 0;
            transition: height 0.1s;
            position: relative;
            height: 50%;
        }
        
        .bar-pct {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.5em;
            font-weight: 700;
            color: #00ffff;
        }
        
        .zone {
            position: absolute;
            bottom: 0;
            width: 30%;
            height: 80px;
            z-index: 10;
            cursor: pointer;
        }
        .zone-left { left: 0; }
        .zone-right { right: 0; }
        
        .radar-container {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 20px auto;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.1) 0%, rgba(0, 0, 0, 0.3) 100%);
            border-radius: 50%;
            border: 3px solid #00ffff;
            overflow: hidden;
            cursor: crosshair;
        }
        
        .radar-sweep {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, #00ffff, transparent);
            transform-origin: left center;
            animation: sweep 3s linear infinite;
        }
        
        @keyframes sweep {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .radar-grid {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
        }
        
        .radar-circle {
            width: 100%;
            height: 100%;
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        
        .radar-dot {
            position: absolute;
            width: 14px;
            height: 14px;
            background: #ff0080;
            border-radius: 50%;
            box-shadow: 0 0 20px #ff0080;
            animation: radarPulse 2s ease-in-out infinite;
            transform: translate(-50%, -50%);
            z-index: 5;
            left: 50%;
            top: 50%;
        }
        
        @keyframes radarPulse {
            0% { 
                transform: translate(-50%, -50%) scale(1); 
                opacity: 1;
                box-shadow: 0 0 20px #ff0080;
            }
            50% { 
                transform: translate(-50%, -50%) scale(2); 
                opacity: 0.3;
                box-shadow: 0 0 40px #ff0080;
            }
            100% { 
                transform: translate(-50%, -50%) scale(1); 
                opacity: 1;
                box-shadow: 0 0 20px #ff0080;
            }
        }
        
        /* Wheel of Fortune Styles */
        .wheel-container {
            position: relative;
            width: 320px;
            height: 320px;
            margin: 30px auto;
        }
        
        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 6px solid #ffff00;
            position: relative;
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            background: conic-gradient(
                from 0deg,
                #FFD700 0deg 120deg,
                #FF1493 120deg 240deg,
                #8B00FF 240deg 360deg
            );
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.6);
        }
        
        .wheel-emoji {
            position: absolute;
            font-size: 3em;
            transform: translate(-50%, -50%);
            filter: drop-shadow(0 0 5px rgba(0,0,0,0.5));
            pointer-events: none;
        }
        
        .emoji-laugh {
            top: 25%;
            left: 75%;
        }
        
        .emoji-heart {
            top: 75%;
            left: 50%;
        }
        
        .emoji-scary {
            top: 25%;
            left: 25%;
        }
        
        .wheel-pointer {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 30px solid #ff0080;
            z-index: 10;
            filter: drop-shadow(0 0 15px #ff0080);
        }
        
        .wheel-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 70px;
            background: #0a0e27;
            border-radius: 50%;
            border: 4px solid #ffff00;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            z-index: 5;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }
        
        .challenge-result {
            background: rgba(255, 0, 128, 0.2);
            border: 2px solid #ff0080;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2em;
            font-weight: 700;
            color: #00ffff;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .legend {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
        }
        
        .color-laugh { background: #FFD700; }
        .color-heart { background: #FF1493; }
        .color-scary { background: #8B00FF; }
        
        .info-icon {
            position: relative;
            display: inline-block;
            width: 24px;
            height: 24px;
            background: rgba(0, 255, 255, 0.3);
            border: 2px solid #00ffff;
            border-radius: 50%;
            color: #00ffff;
            font-size: 14px;
            font-weight: 700;
            text-align: center;
            line-height: 20px;
            cursor: help;
            margin-left: 10px;
            vertical-align: middle;
        }
        
        .info-icon:hover {
            background: rgba(0, 255, 255, 0.5);
        }
        
        .info-tooltip {
            visibility: hidden;
            position: absolute;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.95);
            color: #00ffff;
            padding: 15px 20px;
            border-radius: 10px;
            border: 2px solid #00ffff;
            font-size: 14px;
            font-weight: 400;
            width: 280px;
            top: 35px;
            right: 0;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }
        
        .info-icon:hover .info-tooltip {
            visibility: visible;
        }
        
        .info-icon.active .info-tooltip {
            visibility: visible;
        }
        
        .chart-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes scaleIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        @media (max-width: 600px) {
            .radar-container { width: 240px; height: 240px; }
            .wheel-container { width: 280px; height: 280px; }
            .wheel-emoji { font-size: 2.5em; }
        }
    </style>
</head>
<body>
    <div id="installPopup" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); z-index: 10000; align-items: center; justify-content: center; animation: fadeIn 0.3s ease;">
        <div style="background: linear-gradient(135deg, #1a0f2e, #0a0e27); border: 2px solid #ff0080; border-radius: 20px; padding: 30px; max-width: 400px; margin: 20px; box-shadow: 0 10px 40px rgba(255, 0, 128, 0.3); animation: scaleIn 0.3s ease;">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 4em; margin-bottom: 10px;">üì±</div>
                <h2 style="color: #00ffff; margin: 0 0 10px 0; font-size: 1.8em;">Enjoying the app?</h2>
                <p style="color: #ffff00; margin: 0; font-size: 1.1em;">Add to home screen for quick access next time!</p>
            </div>
            <div style="background: rgba(0, 255, 255, 0.1); border: 1px solid #00ffff; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                <div style="color: white; font-size: 0.95em; line-height: 1.6;">
                    ‚úì Launch instantly from home screen<br>
                    ‚úì Works offline after first visit<br>
                    ‚úì No app store needed
                </div>
            </div>
            <div style="display: flex; gap: 10px;">
                <button onclick="installFromPopup()" style="flex: 1; background: #ff0080; color: white; border: none; padding: 15px; border-radius: 12px; font-weight: bold; font-size: 1.1em; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 0, 128, 0.4);">Add Now</button>
                <button onclick="dismissPopup()" style="flex: 1; background: rgba(255, 255, 255, 0.1); color: white; border: 2px solid #00ffff; padding: 15px; border-radius: 12px; font-weight: bold; font-size: 1.1em; cursor: pointer;">Not Now</button>
            </div>
        </div>
    </div>

<div class="container" style="padding-top: 20px;">
    <h1>FUN IN BARS</h1>
    
    <div id="retentionDashboard" style="max-width: 600px; margin: 20px auto 30px;">
        
        <div style="background: linear-gradient(135deg, #ff0080, #ff6b9d); border-radius: 15px; padding: 20px; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(255, 0, 128, 0.3);">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div style="color: #ffff00; font-size: 0.9em; font-weight: bold;">YOUR STREAK</div>
                    <div style="color: white; font-size: 2.5em; font-weight: 900; line-height: 1;" id="streakCount">0</div>
                    <div style="color: rgba(255, 255, 255, 0.8); font-size: 0.85em;" id="streakMessage">Start your streak!</div>
                </div>
                <div style="font-size: 4em; line-height: 1;">üî•</div>
            </div>
        </div>
        
        <div style="background: rgba(255, 215, 0, 0.15); border: 2px solid #ffd700; border-radius: 15px; padding: 20px; margin-bottom: 15px;">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <span style="font-size: 2em;">üéØ</span>
                <div>
                    <div style="color: #ffd700; font-weight: bold; font-size: 1.1em;">TODAY'S DARE</div>
                    <div style="color: #ffff00; font-size: 0.85em;">Complete for 2X points!</div>
                </div>
            </div>
            <div style="color: white; font-size: 1.1em; line-height: 1.5; margin: 15px 0;" id="dailyDareText">Loading...</div>
            <div style="display: flex; gap: 10px;">
                <button class="btn" onclick="acceptDailyDare()" id="acceptDareBtn" style="flex: 1; background: #00cc00;">‚úì ACCEPT DARE</button>
                <div style="color: #00ffff; font-size: 0.9em; display: flex; align-items: center;" id="dareStatus"></div>
            </div>
        </div>
        
        <div style="background: rgba(0, 255, 255, 0.15); border: 2px solid #00ffff; border-radius: 15px; padding: 20px;">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                <span style="font-size: 2em;">‚≠ê</span>
                <div>
                    <div style="color: #00ffff; font-weight: bold; font-size: 1.1em;">OPENER OF THE WEEK</div>
                    <div style="color: rgba(0, 255, 255, 0.7); font-size: 0.85em;">Resets every Monday</div>
                </div>
            </div>
            <div style="color: white; font-size: 1.1em; line-height: 1.5; margin: 15px 0;" id="weeklyOpenerText">Loading...</div>
            <button class="btn" onclick="useWeeklyOpener()" style="width: 100%; background: #ff0080;">üí¨ USE THIS OPENER</button>
        </div>
    </div>

    <div class="phases">
        <button class="phase-btn active" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('pre-party').classList.add('active');" style="display: none;">üè† Pre-Party</button>
        <button class="phase-btn" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('on-the-way').classList.add('active');" style="display: none;">üöï On the Way</button>
        <button class="phase-btn" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('at-the-bar').classList.add('active');" style="display: none;">üçª At the Bar</button>
        <button class="phase-btn" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('bingo').classList.add('active'); if(!window.bingoInitialized) initBingo();" style="display: none;">üéØ Bingo</button>
        <button class="phase-btn active" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('roulette').classList.add('active'); resetRouletteToStart();">üé∞ Roulette</button>
        <button class="phase-btn" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('challenge-wheel').classList.add('active');">üéØ Challenge</button>
        <button class="phase-btn" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('compete').classList.add('active'); resetCompeteMode();">üèÜ Compete</button>
        <button class="phase-btn" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('radar-chart').classList.add('active');">üì° Radar</button>
        <button class="phase-btn" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('boldness').classList.add('active');">üìä Meter</button>
        <button class="phase-btn" onclick="var btns=document.querySelectorAll('.phase-btn'); for(var i=0;i<btns.length;i++)btns[i].classList.remove('active'); this.classList.add('active'); var phases=document.querySelectorAll('.phase-content'); for(var i=0;i<phases.length;i++)phases[i].classList.remove('active'); document.getElementById('going-home').classList.add('active');" style="display: none;">üåô Going Home</button>
    </div>

    <div class="phase-content" id="pre-party">
        <div class="phase-title">üè† PRE-PARTY</div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">üç∫ Drinking Games</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <div class="item"><strong>Never Have I Ever</strong> - Take turns saying "Never have I ever..." and drink if you've done it!</div>
                <div class="item"><strong>Flip Cup</strong> - Race to drink and flip your cup upside down. First team to finish wins!</div>
                <div class="item"><strong>Most Likely To</strong> - Someone asks "Who's most likely to...?" Everyone points. Person with most fingers drinks!</div>
                <div class="item"><strong>Paranoia</strong> - Whisper a question about someone. They drink and can ask who it's about if they drink again!</div>
                <div class="item"><strong>Truth or Drink</strong> - Ask anything. They either answer truthfully or take a drink!</div>
            </div>
        </div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">üé§ Party Songs to Sing</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <div class="list-item">
                    <div class="list-title">üéµ Mr. Brightside - The Killers</div>
                    Essential sing-along anthem!
                </div>
                <div class="list-item">
                    <div class="list-title">üéµ Don't Stop Believin' - Journey</div>
                    Everyone knows the chorus!
                </div>
                <div class="list-item">
                    <div class="list-title">üéµ Sweet Caroline - Neil Diamond</div>
                    "BAH BAH BAH!" - Gets everyone involved
                </div>
                <div class="list-item">
                    <div class="list-title">üéµ Livin' on a Prayer - Bon Jovi</div>
                    Perfect for the pre-game hype!
                </div>
                <div class="list-item">
                    <div class="list-title">üéµ Wannabe - Spice Girls</div>
                    Fast-paced fun for everyone
                </div>
            </div>
        </div>
    </div>

    <div class="phase-content" id="on-the-way">
        <div class="phase-title">üöï ON THE WAY</div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">üöó Yellow Car Spotting</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <p style="text-align: center; margin-bottom: 20px; color: #00ffff;">Spot yellow cars and tap to score! First to 10 wins! üèÜ</p>
                <div class="counter" id="carCount">0</div>
                <button class="btn" onclick="event.stopPropagation(); var c=document.getElementById('carCount'); c.textContent=parseInt(c.textContent)+1;">SPOT YELLOW CAR! üöï</button>
                <button class="btn" onclick="event.stopPropagation(); document.getElementById('carCount').textContent='0';" style="background: rgba(255,255,255,0.1);">Reset Counter</button>
            </div>
        </div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">üéÆ Taxi Games</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <div class="item"><strong>License Plate Game</strong> - Find letters A-Z in order on license plates!</div>
                <div class="item"><strong>Song Lyrics Battle</strong> - Someone starts a song, next person continues. First to mess up loses!</div>
                <div class="item"><strong>20 Questions</strong> - Think of something, others get 20 yes/no questions to guess it!</div>
                <div class="item"><strong>Red Car vs Blue Car</strong> - Split into teams. Count your team's color. Winner buys first round!</div>
            </div>
        </div>
    </div>

    <div class="phase-content" id="at-the-bar">
        <div class="phase-title">üçª AT THE BAR</div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">‚ú® Simple Magic Tricks</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <div class="list-item">
                    <div class="list-title">üé© The Disappearing Coin</div>
                    Palm a coin while pretending to transfer it to your other hand. Open empty hand dramatically!
                </div>
                <div class="list-item">
                    <div class="list-title">üÉè Pick a Card Mind Reading</div>
                    Let them pick a card, have them show others. Glimpse bottom card when they return it, then "read their mind"!
                </div>
                <div class="list-item">
                    <div class="list-title">ü™Ñ The Floating Bill</div>
                    Hold a bill between your thumb and pinky while hiding your hand behind it. It looks like it's floating!
                </div>
                <div class="list-item">
                    <div class="list-title">üé≤ Predict Their Number</div>
                    Ask them to pick 1-10, double it, add 8, divide by 2, subtract original. Answer is always 4! Write it down first.
                </div>
            </div>
        </div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">üí¨ Opening Lines</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <div class="item">"Hey! My friends and I are debating: Is a hot dog a sandwich? We need a tiebreaker!" üå≠</div>
                <div class="item">"Quick question - if you could only eat one food for the rest of your life, what would it be?" üçï</div>
                <div class="item">"We're doing truths or dares. Want to join? You look brave enough!" üéØ</div>
                <div class="item">"I lost a bet and have to get 5 people's favorite songs. What's yours?" üéµ</div>
                <div class="item">"You look like someone who knows where the best [food] in this city is. Am I right?" üçî</div>
            </div>
        </div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">üëä Physical Games</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <div class="item"><strong>Thumb Wars</strong> - Classic 1v1 battle! "1, 2, 3, 4, I declare a thumb war!" üëç</div>
                <div class="item"><strong>Rock Paper Scissors Tournament</strong> - Best of 3, winner challenges next person! ‚úä‚úã‚úåÔ∏è</div>
                <div class="item"><strong>Staring Contest</strong> - First to blink or laugh loses! No touching! üëÄ</div>
                <div class="item"><strong>Coin Balance</strong> - Balance a coin on your elbow, catch it! Most catches wins! ü™ô</div>
            </div>
        </div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">üé≤ Non-Physical Games</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <div class="item"><strong>Kiss, Marry, Kill</strong> - Choose 3 people/celebs. Others decide kiss, marry, or kill! üíãüíçüíÄ</div>
                <div class="item"><strong>Would You Rather</strong> - Impossible choices! "Would you rather have hiccups forever or feel like you need to sneeze forever?" ü§î</div>
                <div class="item"><strong>Two Truths and a Lie</strong> - Say 3 statements, others guess which is fake! üé≠</div>
                <div class="item"><strong>Category Game</strong> - Pick a category (movies, bands, etc). Go around naming items. First to repeat or freeze loses! üéØ</div>
            </div>
        </div>
    </div>

    <div class="phase-content" id="going-home">
        <div class="phase-title">üåô GOING HOME</div>

        <div class="card" onclick="this.classList.toggle('expanded')">
            <div class="card-header">
                <div class="card-title">üéÆ Challenges</div>
                <div class="expand-icon">‚ñº</div>
            </div>
            <div class="card-content">
                <div class="item"><strong>Guess the Song</strong> - Hum a song, others have 3 guesses! üéµ</div>
                <div class="item"><strong>Memory Challenge</strong> - Name everyone you talked to tonight! Can you remember them all? üß†</div>
                <div class="item"><strong>Accent Challenge</strong> - Tell a story in a random accent! üó£Ô∏è</div>
                <div class="item"><strong>Rhyme Time</strong> - Pick a word, take turns rhyming. First to fail loses! üìù</div>
                <div class="item"><strong>Tonight's Highlights</strong> - Everyone shares their favorite moment from the night! ‚≠ê</div>
            </div>
        </div>
    </div>

    <div class="phase-content" id="challenge-wheel">
        <div class="legend" style="margin-top: 30px;">
            <div class="legend-item">
                <div class="legend-color color-laugh"></div>
                <span>üòÇ Laugh</span>
            </div>
            <div class="legend-item">
                <div class="legend-color color-heart"></div>
                <span>‚ù§Ô∏è Compliment</span>
            </div>
            <div class="legend-item">
                <div class="legend-color color-scary"></div>
                <span>üò± Scary</span>
            </div>
        </div>
        <div class="wheel-container" style="margin: 30px auto;">
            <div class="wheel-pointer"></div>
            <div class="wheel" id="wheel">
                <div class="wheel-emoji emoji-laugh">üòÇ</div>
                <div class="wheel-emoji emoji-heart">‚ù§Ô∏è</div>
                <div class="wheel-emoji emoji-scary">üò±</div>
                <div class="wheel-center">üéØ</div>
            </div>
        </div>
        <div class="challenge-result" id="challengeResult" style="max-width: 500px; margin: 20px auto;">
            Click "SPIN THE WHEEL" to get your challenge! üé∞
        </div>
        <button class="btn" style="max-width: 500px; margin: 0 auto; display: block;" onclick="if(!window.usedChallenges) window.usedChallenges = {}; var challenges=[{type:'laugh',text:'üòÇ Make the bartender genuinely laugh within 1 minute!'},{type:'laugh',text:'üòÇ Tell your funniest story and make everyone at your table laugh!'},{type:'laugh',text:'üòÇ Do your best celebrity impression!'},{type:'laugh',text:'üòÇ Tell a joke - if nobody laughs, you drink!'},{type:'laugh',text:'üòÇ Do your worst dance move for 30 seconds!'},{type:'laugh',text:'üòÇ Speak in an accent for the next 5 minutes!'},{type:'compliment',text:'‚ù§Ô∏è Give genuine compliments to 3 strangers!'},{type:'compliment',text:'‚ù§Ô∏è Compliment someone on their style and ask where they got their outfit!'},{type:'compliment',text:'‚ù§Ô∏è Tell someone nearby what you admire about them!'},{type:'compliment',text:'‚ù§Ô∏è Compliment the bartender and thank them for their work!'},{type:'compliment',text:'‚ù§Ô∏è Tell everyone in your group one thing you appreciate about them!'},{type:'compliment',text:'‚ù§Ô∏è Give a genuine compliment to someone who looks like they need it!'},{type:'scary',text:'üò± Ask the bouncer for their scariest bar story!'},{type:'scary',text:'üò± Challenge someone to a staring contest - first to blink loses!'},{type:'scary',text:'üò± Ask a stranger what their biggest fear is!'},{type:'scary',text:'üò± Share your most embarrassing moment with the group!'},{type:'scary',text:'üò± Challenge a stranger to rock-paper-scissors, best of 3!'},{type:'scary',text:'üò± Ask someone what their first impression of you was!'}]; var wheel=document.getElementById('wheel'); var result=document.getElementById('challengeResult'); var rotations = 5; var extraDegrees = Math.random() * 360; var totalRotation = (rotations * 360) + extraDegrees; var currentRotation = parseFloat(wheel.style.transform.replace('rotate(','').replace('deg)','')) || 0; wheel.style.transform='rotate('+(currentRotation + totalRotation)+'deg)'; result.textContent='üé∞ Spinning...'; setTimeout(function(){ var finalAngle = (360 - ((currentRotation + totalRotation) % 360)) % 360; var category; if(finalAngle >= 0 && finalAngle < 120) { category = 'laugh'; } else if(finalAngle >= 120 && finalAngle < 240) { category = 'compliment'; } else { category = 'scary'; } if(!window.usedChallenges[category]) window.usedChallenges[category] = []; var matchingChallenges = challenges.filter(function(c){ return c.type === category; }); var availableChallenges = matchingChallenges.filter(function(c){ return window.usedChallenges[category].indexOf(c.text) === -1; }); if(availableChallenges.length === 0) { window.usedChallenges[category] = []; availableChallenges = matchingChallenges; } var randomChallenge = availableChallenges[Math.floor(Math.random() * availableChallenges.length)]; window.usedChallenges[category].push(randomChallenge.text); result.textContent=randomChallenge.text;},4000);">SPIN THE WHEEL! üé∞</button>
    </div>

    <div class="phase-content" id="bingo">
        <div class="phase-title">üéØ OPENING LINES BINGO</div>
        <p style="text-align: center; color: #00ffff; margin-bottom: 30px;">Use 3 opening lines in a row to get BINGO!</p>
        <div id="bingoBoard" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-width: 500px; margin: 0 auto 30px;"></div>
        <button class="btn" onclick="initBingo();" style="max-width: 300px; margin: 0 auto; display: block;">üîÑ New Game</button>
    </div>

    <div class="phase-content active" id="roulette">
        <div class="phase-title">üé∞ OPENING LINE ROULETTE</div>
        <p style="text-align: center; color: #00ffff; margin-bottom: 20px;">Spin to assign challenges to players!</p>
        
        <div id="playerCountSection" style="max-width: 500px; margin: 30px auto;">
            <h3 style="color: #00ffff; text-align: center; margin-bottom: 20px;">How many players?</h3>
            <div style="display: flex; gap: 10px; justify-content: center;">
                <button class="btn" onclick="setPlayerCount(1)" style="flex: 1;">1</button>
                <button class="btn" onclick="setPlayerCount(2)" style="flex: 1;">2</button>
                <button class="btn" onclick="setPlayerCount(3)" style="flex: 1;">3</button>
                <button class="btn" onclick="setPlayerCount(4)" style="flex: 1;">4</button>
                <button class="btn" onclick="setPlayerCount(5)" style="flex: 1;">5</button>
            </div>
        </div>
        
        <div id="playerNamesSection" style="display: none; max-width: 500px; margin: 30px auto;">
            <h3 style="color: #00ffff; text-align: center; margin-bottom: 20px;">Enter Player Names</h3>
            <p style="text-align: center; color: #ffff00; margin-bottom: 20px; font-size: 0.9em;">(Optional - skip to use default names)</p>
            <div id="nameInputs" style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px;">
                </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn" onclick="startRoulette();" style="flex: 1; background: #00cc00;">‚úì Continue</button>
                <button class="btn" onclick="skipNames();" style="flex: 1; background: #ffaa00;">Skip ‚Üí</button>
            </div>
        </div>
        
        <div id="spinnerSection" style="display: none; max-width: 500px; margin: 30px auto;">
            <div style="background: rgba(255, 0, 128, 0.2); border: 2px solid #ff0080; border-radius: 15px; padding: 30px; margin-bottom: 20px;">
                <h3 style="color: #ffff00; text-align: center; margin-bottom: 15px;" id="spinnerTitle">Spinning...</h3>
                <div id="spinnerDisplay" style="text-align: center; font-size: 2em; font-weight: 900; color: #00ffff; min-height: 80px; display: flex; align-items: center; justify-content: center;">
                    üé∞
                </div>
            </div>
            <button class="btn" id="spinBtn" onclick="spinNext();" style="width: 100%; margin-bottom: 10px;">üé∞ SPIN</button>
            <button class="btn" id="nextBtn" onclick="goToNextStep();" style="width: 100%; background: #00cc00; display: none;">‚û°Ô∏è NEXT</button>
        </div>
        
        <div id="